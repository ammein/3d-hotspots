/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
Command: npx gltfjsx@6.5.3 ./public/model/model.glb -o ./src/components/Globe.jsx -T 
Files: ./public/model/model.glb [9.57MB] > /Users/ASN74/Documents/codes/Interactive Assets/3d-hotspots/src/components/model-transformed.glb [4.88MB] (49%)
*/

import { useEffect, useRef, useState } from "react";
import { useGLTF, useAnimations } from "@react-three/drei";
import { GLTFLoader, DRACOLoader } from "three-stdlib";
import withModelManagement from "./hoc/ModelManagement";

const gltfLoader = new GLTFLoader();
const dracoloader = new DRACOLoader();
dracoloader.setDecoderPath("https://www.gstatic.com/draco/v1/decoders/");
gltfLoader.setDRACOLoader(dracoloader);

function Model(props) {
	const group = useRef();
	const [GLTF, setGLTF] = useState(null);
	const { animations, scene } = useGLTF(props.url);
	const { actions } = useAnimations(animations, group);

	useEffect(() => {
		if (actions) {
			actions.Scene.play();
		}

		scene.traverse((object) => {
			if (object.type === "Mesh") {
				console.log(object);
			}
		});
	}, [actions, scene]);

	gltfLoader.load(props.url, (gltf) => {
		setGLTF(gltf.scene);
	});

	return GLTF && <primitive object={GLTF} />;
}

useGLTF.preload("/model-transformed.glb");

export default withModelManagement(Model);
